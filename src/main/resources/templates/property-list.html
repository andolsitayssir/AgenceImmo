<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link th:replace="layout/default-layout::link">
    <title>All Properties</title>
    
</head>
<body h:action="@{/annonces/property-list}" th:replace="layout/default-layout::body(title='Property List')">

  </script>  
  <div th:fragment="content">

     <div class="row " style="margin-top: 20vh;">
        <div class="col-8">
          <a class="btn btn-primary" th:href="@{/annonces/create-property}">Add a Property</a>
        </div>
    </div>
    <div class="col-12 mt-2">
      <p><strong>Sort by Price:</strong></p>
      <form th:action="@{/annonces/sort}" method="get" id="filterForm">
        <label><input type="radio" name="orderByPrice" value="asc" th:checked="${orderByPrice=='asc'}"
            onchange="document.getElementById('filterForm').submit()"> Ascending</label>
        <label><input type="radio" name="orderByPrice" value="desc" th:checked="${orderByPrice=='desc'}"
            onchange="document.getElementById('filterForm').submit()"> Descending</label>
      </form>

    </div>
        <table class="table table-hover mt-5 ">
  <thead>
    <tr class="table-primary ">
      <th>NÂ°</th>
      <th scope="col">Title</th>
      <th scope="col">Type</th>
      <th scope="col">Category</th>
      <th scope="col">Price</th>
      <th scope="col">Surface</th>
      <th scope="col">Governorate</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tr>
    <td th:if="${#lists.isEmpty(annonces)}" colspan="7">
      <p style="text-align: center;">No property available. Please add a new property.</p>
   </td>
  </tr>
  <tr  th:each="property,state:${annonces}">
    <td th:text="${state.count + (currentPage * pageSize)}"></td>
    <td th:text="${property.titre}"></td>
    <td th:text="${property.type}"></td>
    <td th:text="${property.category}"></td>
    <td th:text="${property.price}"></td>
    <td th:text="${property.surface}"></td>
    <td th:text="${property.address.governorate}"></td>
    <td>
      <form th:action="@{|/annonces/${property.annonce_id}/edit-property|}" method="get" style="display: inline-block; margin-right: 10px;">
          <input type="submit" class="btn btn-secondary" value="Update">
      </form>
      <form th:action="@{|/annonces/${property.annonce_id}/delete-property|}" method="post" style="display: inline-block;">
          <input type="submit" class="btn btn-danger" value="Delete">
      </form>
  </td>
  
    </tr>

<table>
     
  <div class="row mt-5">
    <ul class="pagination pagination-sm w-100 justify-content-center">
        <li class="page-item" th:classappend="${currentPage == 0 ? 'disabled' : ''}">
            <a class="page-link" 
               th:href="${orderByPrice == null ? '/annonces/property-list?page=' + (currentPage - 1) : '/annonces/sort?orderByPrice=' + orderByPrice + '&page=' + (currentPage - 1)}">&laquo;</a>
        </li>
        <li th:each="index: ${#numbers.sequence(0, totalPages - 1)}" class="page-item" th:classappend="${currentPage == index ? 'active' : ''}">
            <a class="page-link" 
               th:href="${orderByPrice == null ? '/annonces/property-list?page=' + index : '/annonces/sort?orderByPrice=' + orderByPrice + '&page=' + index}" 
               th:text="${index + 1}"></a>
        </li>
        <li class="page-item" th:classappend="${currentPage == totalPages - 1 ? 'disabled' : ''}">
            <a class="page-link" 
               th:href="${orderByPrice == null ? '/annonces/property-list?page=' + (currentPage + 1) : '/annonces/sort?orderByPrice=' + orderByPrice + '&page=' + (currentPage + 1)}">&raquo;</a>
        </li>
    </ul>
</div>

  </div> 
</body>
</html>