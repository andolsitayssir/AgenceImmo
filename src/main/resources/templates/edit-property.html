<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Property</title>
    <link th:replace="layout/default-layout::link">
</head>
<body th:replace="layout/default-layout::body(title='Edit Property')">
   <div th:fragment="content">
    <div class="row" style="margin-top: 20vh;">
      <div class="col-8">
        <a class="btn btn-primary" th:href="@{/annonces}">Return to the List</a>
      </div>
    </div>
    <h1 class="form-group fw-bold" style="text-align: center;">Update Property</h1>
    
    <div class="form-group mx-auto mt-3 w-50">
      <h6 class="fw-bold">Current Photos</h6>
      <div th:if="${#lists.isEmpty(photos)}">
        <p>No photos available.</p>
      </div>
      <div class="row">
        <div class="col-md-4 mb-3" th:each="photo : ${photos}">
          <img th:src="@{|/images/${photo.url}|}" alt="Photo" class="img-fluid" style="width: 100%; height: 200px; object-fit: cover;">
         <form th:action="@{|/annonces/photos/${photo.photo_id}/delete|}" method="post"> <button class="btn btn-danger mt-2 mx-auto">Delete Photo</button></form>
        </div>
      </div>
    </div>
    <form th:action="@{|/annonces/${annonce_id}/edit-property|}" th:object="${annonceForm}" method="POST" enctype="multipart/form-data">
       <div class="form-group mx-auto mt-3 w-50">
        <label class="form-label fw-bold" for="title">Title</label>
        <input type="text" class="form-control" placeholder="Title" id="titre" th:classappend="${#fields.hasErrors('titre')}?is-invalid" th:field="*{titre}">
        <span th:if="${#fields.hasErrors('titre')}" th:errors="*{titre}" class="invalid-feedback">Title Error</span>
      </div>
      <p class="form-group fw-bold mx-auto mt-3 w-50">Type</p>
      <div class="form-check form-group mx-auto mt-3 w-50">
        <input class="form-check-input" type="radio" name="type" id="sale" value="sale" th:field="*{type}">
        <label class="form-check-label" for="sale">Sale</label>
      </div>
      <div class="form-check form-group mx-auto mt-3 w-50">
        <input class="form-check-input" type="radio" name="type" id="rental" value="rental" th:field="*{type}">
        <label class="form-check-label" for="rental">Rental</label>
      </div>
      <div class="form-group mx-auto mt-3 w-50">
        <label for="type" class="form-label fw-bold">Category</label>
        <select id="category" class="form-select" th:field="*{category}">
          <option th:each="category : ${categories}" th:value="${category}" th:text="${category}"></option>
        </select>
        <span th:if="${#fields.hasErrors('category')}" th:errors="*{category}" class="invalid-feedback">Category Error</span>
      </div>
      <div class="form-group mx-auto mt-3 w-50">
        <label for="description" class="form-label fw-bold">Details</label>
        <textarea class="form-control" id="description" rows="3" cols="1" th:field="*{description}"></textarea>
        <span th:if="${#fields.hasErrors('description')}" th:errors="*{description}" class="invalid-feedback">Description Error</span>
      </div>
      <p class="form-group mx-auto mt-3 w-50 fw-bold">Phone Number</p>
      <div class="form-group input-group mt-3 mx-auto w-50">
        <span class="input-group-text">+216</span>
        <input type="number" class="form-control" th:classappend="${#fields.hasErrors('tel')}?is-invalid" th:field="*{tel}">
        <span th:if="${#fields.hasErrors('tel')}" th:errors="*{tel}" class="invalid-feedback">Phone number error</span>
      </div>
      <p class="form-group mx-auto mt-3 w-50 fw-bold">Surface</p>
      <div class="form-group input-group mt-3 mx-auto w-50">
        <span class="input-group-text">mÂ²</span>
        <input type="number" class="form-control" th:classappend="${#fields.hasErrors('surface')}?is-invalid" th:field="*{surface}">
        <span th:if="${#fields.hasErrors('surface')}" th:errors="*{surface}" class="invalid-feedback">Surface error</span>
      </div>
      <p class="form-group mx-auto mt-3 w-50 fw-bold">Price</p>
      <div class="form-group input-group mt-3 mx-auto w-50">
        <span class="input-group-text">TND</span>
        <input type="number" class="form-control" aria-label="Amount (to the nearest dollar)" th:classappend="${#fields.hasErrors('price')}?is-invalid" th:field="*{price}">
        <span th:if="${#fields.hasErrors('price')}" th:errors="*{price}" class="invalid-feedback">Price Error</span>
      </div>
      <div class="form-group mx-auto mt-3 w-50">
        <label class="form-label fw-bold" for="title">Governorate</label>
        <input type="text" class="form-control" placeholder="Governorate" id="governorate" th:classappend="${#fields.hasErrors('governorate')}?is-invalid" th:field="*{governorate}">
        <span th:if="${#fields.hasErrors('governorate')}" th:errors="*{governorate}" class="invalid-feedback">Governorate Error</span>
      </div>
      <div class="form-group mx-auto mt-3 w-50">
        <label class="form-label fw-bold" for="title">City</label>
        <input type="text" class="form-control" placeholder="City" id="city" th:classappend="${#fields.hasErrors('city')}?is-invalid" th:field="*{city}">
        <span th:if="${#fields.hasErrors('city')}" th:errors="*{city}" class="invalid-feedback">City Error</span>
      </div>
      <div class="form-group mx-auto mt-3 w-50">
        <label class="form-label fw-bold" for="title">Street</label>
        <input type="text" class="form-control" placeholder="Street" id="street" th:classappend="${#fields.hasErrors('street')}?is-invalid" th:field="*{street}">
        <span th:if="${#fields.hasErrors('street')}" th:errors="*{street}" class="invalid-feedback">Street Error</span>
      </div>

      <div class="form-group mx-auto mt-3 w-50">
        <label for="formFile" class="form-label fw-bold">Upload more Photos</label>
        <input class="form-control" type="file" name="photos" id="formFile" th:field="*{photos}" multiple onchange="previewImages()">
        <span th:if="${#fields.hasErrors('photos')}" th:errors="*{photos}" class="invalid-feedback">Photos Error</span>
      </div>
      <div class="form-group mx-auto mt-3 w-50" id="imagePreview"></div>
      <div class="form-group mx-auto mt-3 w-50">
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>
  </div>
</body>
</html>